{% extends "core/base.html" %}
{% load static %}

{% block css %}
{{ block.super}}
<link rel="stylesheet" href="{% static 'core/css/password.css' %}">

{% endblock css %}


<!-- Seo tags -->
{% block seo %}
<title>Trezunt change password</title>      
<meta name="keywords" content="trezunt, online earning, prediction game">
<meta name="robots" content="noindex" >
{% endblock seo %}


{% block content %}




<form method="POST " class="parent-box"  onsubmit="return validate()" novalidate>
  {% csrf_token %}
  <div class="  py-3">
    <h1 class="rainbow-text mx-3  px-2 py-2" >Change Password</h1>
    <div class="container">
      <div class="bg-light text-center p-2"  >

        <img class="m-3" src="{% static 'core/images/lock.png' %}" alt="">
        <div> {{form.old_password}}</div>
        <p style="font-size: 12px;"  id="password-old-error" class=" mx-5 text-danger"></p>
        <div> {{form.new_password1}}</div>
        <p style="font-size: 12px;" id="password1-error" class=" mx-5 text-danger"></p>
        <p style="font-size: 12px;" id="password2-error" class=" mx-5 text-danger"></p>
        <p style="font-size: 12px;" id="password3-error" class=" mx-5 text-danger"></p>
        <p style="font-size: 12px;" id="password4-error" class=" mx-5 text-danger"></p>
        <div> {{form.new_password2}}</div>
        <p style="font-size: 12px;"  id="password5-error" class=" mx-5 text-danger"></p>
        <input type="submit" class="button-s-base yel-color mb-3"  value="Submit">

      </div>
    </div>
  </div>
</form>

  
{% endblock content %}

{% block js %}
{{block.super}}


<script>


const password_validation_regexExp = /^(?=.*[0-9])(?=.*[- ?!@#$%^&*\/\\])(?=.*[A-Z])(?=.*[a-z])[a-zA-Z0-9- ?!@#$%^&*\/\\]{8,30}$/;


// password 1 validation

function old_password_validation(){
  let pwd0 = $('input[name="old_password"]').val();
  if(pwd0 == ''){
    $('#password-old-error').text('This field is required')
      $('input[name="old_password"]').css('background-color','#fdd0d0')
      return false;
  }else{
    return true;
      $('#password-old-error').text('')
      $('input[name="old_password"]').css('background-color','white')

  }



};


function password_validation(){
            let pwd1 = $('input[name="new_password1"]').val();


            if(pwd1 == ''){
            $('#password1-error').text('This field is required')
            $('#password2-error').text('')
            $('#password3-error').text('')
            $('#password4-error').text('')
            $('input[name="new_password1"]').css('background-color','#fdd0d0')
            return false;
          }else{
            if  (password_validation_regexExp.test(pwd1)){
              $('#password1-error').text('')
              $('#password2-error').text('')
              $('#password3-error').text('')
              $('#password4-error').text('')
              $('input[name="new_password1"]').css('background-color','white')
              return true;
            }else{ 
              $('#password1-error').text('Must have 8 characters')
              $('#password2-error').text('At least one capital letter')
              $('#password3-error').text('At least one special character')
              $('#password4-error').text('At least one numeric letter')
              $('input[name="new_password1"]').css('background-color','#fdd0d0')
              return false;
        }; }; };


// password2  validation
function both_pwd_validate(){
  let pwd1 = $('input[name="new_password1"]').val();
  let pwd2 = $('input[name="new_password2"]').val();

  if (pwd2 == ""){
      $('#password5-error').text('This field is required')
      $('input[name="new_password2"]').css('background-color','#fdd0d0')
      return false;
  }else{
    if(pwd1 != pwd2){
      $('#password5-error').text('Password doesnot match')
      $('input[name="new_password2"]').css('background-color','#fdd0d0')
      return false;
    }else{
      return true;
      $('#password5-error').text('')
      $('input[name="new_password2"]').css('background-color','white')
  };  };};


function validate(){
  password_validation()
  both_pwd_validate()
  old_password_validation()
  if(password_validation() ==  true &&  both_pwd_validate() == true &&  old_password_validation() == true){
    return true;
  }else{
    return false;
  }

}


</script>
{% endblock js %}
  